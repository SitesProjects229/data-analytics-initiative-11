import { abs, float, fract, mod, select, step, vec2, vec4 } from "three/tsl";
const applyEdgeHandling = (distortedUV, sampledColor, childTexture, edgeModeUniform) => {
	const inBoundsX = step(float(0), distortedUV.x).mul(step(distortedUV.x, float(1)));
	const inBoundsY = step(float(0), distortedUV.y).mul(step(distortedUV.y, float(1)));
	const inBounds = inBoundsX.mul(inBoundsY);
	const transparentColor = vec4(sampledColor.rgb, sampledColor.a.mul(inBounds));
	if (!childTexture) return select(step(float(.5), edgeModeUniform), transparentColor, sampledColor);
	const mirrorX = mod(abs(distortedUV.x), float(2));
	const mirrorY = mod(abs(distortedUV.y), float(2));
	const mirroredUV = vec2(select(step(float(1), mirrorX), float(2).sub(mirrorX), mirrorX), select(step(float(1), mirrorY), float(2).sub(mirrorY), mirrorY));
	const mirrorColor = childTexture.sample(mirroredUV);
	const wrappedUV = vec2(fract(distortedUV.x), fract(distortedUV.y));
	const wrapColor = childTexture.sample(wrappedUV);
	return select(step(float(.5), edgeModeUniform), select(step(float(1.5), edgeModeUniform), select(step(float(2.5), edgeModeUniform), wrapColor, mirrorColor), transparentColor), sampledColor);
};
export { applyEdgeHandling as t };
